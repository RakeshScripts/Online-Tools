<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>PDF to Word</title>

<!-- PDF.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>

<!-- DOCX -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/docx/8.5.0/docx.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

<style>
/* ===== SAME THEME CSS ===== */
* {
  box-sizing: border-box;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
}
body {
  background: #1e1e2f;
  color: #ffffff;
  min-height: 100vh;
  margin: 0;
  display: flex;
  justify-content: center;
  align-items: center;
}
.container {
  max-width: 720px;
  width: 100%;
  padding: 24px;
}
.info-box {
  background: rgba(255, 215, 0, 0.1);
  border: 1px solid rgba(255, 215, 0, 0.3);
  padding: 24px;
  border-radius: 18px;
  text-align: center;
  margin-bottom: 32px;
}
.info-box h3 {
  color: #ffd700;
  margin-bottom: 6px;
}
.info-box p {
  font-size: 14px;
  color: #b0b0b0;
}
.upload-box {
  background: #3a3d5b;
  padding: 40px;
  border-radius: 24px;
  border: 2px dashed #555;
  text-align: center;
  margin-bottom: 24px;
  cursor: pointer;
}
.upload-box.active,
.upload-box:hover {
  border-color: #ffd700;
}
.icon {
  font-size: 52px;
  margin-bottom: 10px;
}
.merge-btn {
  width: 100%;
  padding: 16px;
  border-radius: 14px;
  border: none;
  font-size: 18px;
  font-weight: bold;
  background: #ffd700;
  color: #1e1e2f;
  cursor: pointer;
}
.merge-btn:disabled {
  background: #555;
  color: #999;
  cursor: not-allowed;
}
.status {
  margin-top: 12px;
  text-align: center;
  font-weight: bold;
}
.success { color: #2ecc71; }
.error { color: #ff6b6b; }
</style>
</head>

<body>
<div class="container">

  <div class="info-box">
    <h3>PDF to Word Converter</h3>
    <p>Extracts text from PDF and converts it to a Word (.docx) file.  
    <br>100% private ‚Äî runs in your browser.</p>
  </div>

  <div class="upload-box" id="uploadBox" onclick="fileInput.click()">
    <div class="icon">üìÑ</div>
    <div id="fileName"><b>Click to Upload PDF</b></div>
  </div>

  <input type="file" id="fileInput" accept=".pdf" hidden />

  <button class="merge-btn" id="convertBtn" disabled>
    üìù Convert to Word
  </button>

  <div class="status" id="status"></div>

</div>

<script>
const fileInput = document.getElementById("fileInput");
const uploadBox = document.getElementById("uploadBox");
const fileNameEl = document.getElementById("fileName");
const convertBtn = document.getElementById("convertBtn");
const statusText = document.getElementById("status");

let pdfFile = null;

fileInput.onchange = (e) => {
  pdfFile = e.target.files[0];
  if (!pdfFile) return;

  uploadBox.classList.add("active");
  fileNameEl.innerHTML = `<b>${pdfFile.name}</b>`;
  convertBtn.disabled = false;
  statusText.textContent = "";
};

convertBtn.onclick = async () => {
  if (!pdfFile) return;

  try {
    convertBtn.disabled = true;
    statusText.textContent = "Extracting text from PDF...";

    const arrayBuffer = await pdfFile.arrayBuffer();
    const pdf = await pdfjsLib.getDocument({ data: arrayBuffer }).promise;

    const paragraphs = [];

    for (let i = 1; i <= pdf.numPages; i++) {
      statusText.textContent = `Processing page ${i}/${pdf.numPages}...`;
      const page = await pdf.getPage(i);
      const content = await page.getTextContent();

      let pageText = "";
      content.items.forEach(item => {
        pageText += item.str + " ";
      });

      paragraphs.push(
        new docx.Paragraph({
          text: pageText.trim(),
          spacing: { after: 300 }
        })
      );
    }

    statusText.textContent = "Generating Word document...";

    const doc = new docx.Document({
      sections: [
        {
          properties: {},
          children: paragraphs
        }
      ]
    });

    const blob = await docx.Packer.toBlob(doc);
    saveAs(blob, pdfFile.name.replace(".pdf", ".docx"));

    statusText.textContent = "‚úÖ Word file downloaded successfully!";
    statusText.classList.add("success");

  } catch (err) {
    console.error(err);
    statusText.textContent = "‚ùå Conversion failed. PDF may be scanned or encrypted.";
    statusText.classList.add("error");
  } finally {
    convertBtn.disabled = false;
  }
};
</script>

</body>
</html>
